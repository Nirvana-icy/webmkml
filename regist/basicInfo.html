<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="UTF-8"/>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">
	<meta name="description" content="麦壳麦粒儿童悦读之家" />
    <meta name="format-detection" content="telephone=no">
	<title>填写资料</title>
	<script type="text/javascript" src="../js/jquery-2.0.3.min.js"></script>
	<script type="text/javascript" src="../js/jquery.cookies.2.2.0.min.js"></script>
	<script type="text/javascript" src="../js/base.js"></script>
	<script type="text/javascript" src="../js/jweixin-1.0.0.js"></script>
	<script type="text/javascript" src="../js/jQuery.md5.js"></script>
	<script type="text/javascript" src="../js/getVerifyNumBtn.js"></script>
	<link rel="stylesheet" type="text/css" href="../css/public.css" />
  <link rel="stylesheet" type="text/css" href="../css/basicInfo.css" />
	<style type="text/css">
.head_add_input {
  font-size:13px;
  border:1px solid #FFE610;
  padding: 3px;
  line-height:22px;
  border-radius:6px;
  color:#000;
}

.input {
  color:#000;
  font-size:13px;
  border:none;
  padding: 3px;
  line-height:22px;
  min-width:100px;

}

.input_title {
	width: 65px;
  display:inline-block;margin-right:5px;

}

	</style>
</head>
<body>
<form action="http://121.41.98.144/mmUser/register/" id="form1" name="form1" method="post">
<div class="head">
	<span class="head_title">个人信息</span>
</div>

<div class="add_info">
	<div class="add-row">
		<span class="input_title">手机号</span>
		<input name="phoneNum" id="phoneNum" class="input" type="text" value="" placeholder="请输入您的手机号" />
	</div>
	<div class="add-row">
		<span class="input_title">密码</span>
		<input name="pw_1" id="pw_1" class="input" type="password" value="" placeholder="请设置六位密码" />
	</div>

  <div class="add-row">
		<span class="input_title">确认密码</span>
		<input name="pw_2" id="pw_2" class="input" type="password" value="" placeholder="请再次输入密码" />
	</div>

  <div class="add-row">
		<span class="input_title">验证码</span>
		<input name="validNum" id="validNum" class="input" type="text" value="" placeholder="请输入验证码" />
    <button class="fr">
  		<a href="#" class="button_ok" id="getVerifyNumBtn" onclick="return BasicInfo.getVerifyNum();">发送验证码</a>
  	</span>
	</div>

  <div class="add-row">
	   <div class="button_ok_div">
		     <a href="#" class="button_ok" onclick="return Address.save();">下一步</a>
	  </div>
  </div>
</div>
</form>

<script type="text/javascript">
var Address = {
	order_id : 0,

	save: function() {
		var phoneNum = $('#phoneNum').val();
		var pw_1 = $('#pw_1').val();
		var pw_2 = $('#pw_2').val();
		var validNum = $('#validNum').val();

		if(phoneNum == '') {
			M._alert('请输入手机号');
			return false;
		}

		if(pw_1 != pw_1) {
			M._alert('请核对您的密码');
			return false;
		}

		if(validNum =='') {
			M._alert('请输入联系电话');
			return false;
		}

		var param = {
			id: $('#id').val(),
			add_name: add_name,
			username: username,
			mobile: mobile,
			province: province,
			city: city,
			district: district,
			building: building,
			user_add: user_add,
		};

		$.post("/KxfAddress/add", param, function(e){
			if(0 === Number(e.ret)) {
				location.href = "/KxfBase/address_manager?order_id="+Address.order_id;
			}
		});
		return false;
	},

	init: function() {
		$('#province').bind('change', function(){
			var val = $(this).children('option:selected').val();
			$('#city option').remove();
			$('#city').append("<option value='0'>市</option>");
			var param = { provincename : val };
			$.post("/KxfAddress/getCityList", param, function(r) {
				if(Number(r.ret) === 0 && r.result.length > 0) {
					$.each(r.result, function(n, i) {
						$('#city').append("<option value='"+i.name+"'>"+i.name+"</option>");
					});
				}
			});

			$('#district option').remove();
			$('#district').append("<option value='0'>商圈/社区</option>");

			$('#building option').remove();
			$('#building').append("<option value='0'>楼栋</option>");
		});

		$('#city').bind('change', function(){
			var val = $(this).children('option:selected').val();
			$('#district option').remove();
			$('#district').append("<option value='0'>商圈/社区</option>");
			var param = {
				provincename : $('#province').children('option:selected').val(),
				cityname : val
			};
			$.post("http://121.41.98.144/mmUser/register/", param, function(r) {
				if(Number(r.ret) === 0 && r.result.length > 0) {
					$.each(r.result, function(n, i) {
						$('#district').append("<option value='"+i.name+"'>"+i.name+"</option>");
					});
				}
			});

			$('#building option').remove();
			$('#building').append("<option value='0'>楼栋</option>");
		});

		$('#district').bind('change', function(){
			var val = $(this).children('option:selected').val();

			$('#building option').remove();
			$('#building').append("<option value='0'>楼栋</option>");
			var param = {
				provincename : $('#province').children('option:selected').val(),
				cityname : $('#city').children('option:selected').val(),
				districtname : val,
			};
			$.post("/KxfAddress/getBuildingList", param, function(r) {
				if(Number(r.ret) === 0 && r.result.length > 0) {
					$.each(r.result, function(n, i) {
						$('#building').append("<option value='"+i.name+"'>"+i.name+"</option>");
					});
				}
			});
		});
	}
};
Address.init();
</script>
</body>
</html>
